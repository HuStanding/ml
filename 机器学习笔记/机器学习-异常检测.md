[toc]

# ä¸€ã€ä»€ä¹ˆæ˜¯å¼‚å¸¸æ£€æµ‹

**å¼‚å¸¸æ£€æµ‹**(Anomaly detection)ä¸»è¦ç”¨äºŽæ£€æµ‹å¼‚å¸¸æ•°æ®ã€‚

ä¸¾ä¸ªðŸŒ°ï¼Œå‡æƒ³ä½ æ˜¯ä¸€ä¸ªé£žæœºå¼•æ“Žåˆ¶é€ å•†ï¼Œå½“ä½ ç”Ÿäº§çš„é£žæœºå¼•æ“Žä»Žç”Ÿäº§çº¿ä¸Šæµå‡ºæ—¶ï¼Œä½ éœ€è¦è¿›è¡ŒQA(è´¨é‡æŽ§åˆ¶æµ‹è¯•)ï¼Œè€Œä½œä¸ºè¿™ä¸ªæµ‹è¯•çš„ä¸€éƒ¨åˆ†ï¼Œä½ æµ‹é‡äº†é£žæœºå¼•æ“Žçš„ä¸€äº›ç‰¹å¾å˜é‡ï¼Œæ¯”å¦‚å¼•æ“Žè¿è½¬æ—¶äº§ç”Ÿçš„çƒ­é‡ï¼Œæˆ–è€…å¼•æ“Žçš„æŒ¯åŠ¨ç­‰ç­‰ã€‚è¿™æ ·ä¸€æ¥ï¼Œä½ å°±æœ‰äº†ä¸€ä¸ªæ•°æ®é›†ï¼Œä»Ž $x^{(1)}$ åˆ° $x^{(m)}$ï¼Œå¦‚æžœä½ ç”Ÿäº§äº† $m$ ä¸ªå¼•æ“Žçš„è¯ï¼Œä½ å°†è¿™äº›æ•°æ®ç»˜åˆ¶æˆå›¾è¡¨ï¼Œçœ‹èµ·æ¥å°±æ˜¯è¿™ä¸ªæ ·å­ï¼š

![image-20200213204200979](https://tva1.sinaimg.cn/large/0082zybply1gbv247oltvj30no0d0ac6.jpg)

è¿™é‡Œçš„æ¯ä¸ªç‚¹ã€æ¯ä¸ªå‰ï¼Œéƒ½æ˜¯ä½ çš„æ— æ ‡ç­¾æ•°æ®ã€‚è¿™æ ·ï¼Œå¼‚å¸¸æ£€æµ‹é—®é¢˜å¯ä»¥å®šä¹‰å¦‚ä¸‹ï¼šæˆ‘ä»¬å‡è®¾åŽæ¥æœ‰ä¸€å¤©ï¼Œä½ æœ‰ä¸€ä¸ªæ–°çš„é£žæœºå¼•æ“Žä»Žç”Ÿäº§çº¿ä¸Šæµå‡ºï¼Œè€Œä½ çš„æ–°é£žæœºå¼•æ“Žæœ‰ç‰¹å¾å˜é‡ $x^{(test)}$ã€‚æ‰€è°“çš„å¼‚å¸¸æ£€æµ‹é—®é¢˜å°±æ˜¯ï¼šæˆ‘ä»¬å¸Œæœ›çŸ¥é“è¿™ä¸ªæ–°çš„é£žæœºå¼•æ“Žæ˜¯å¦æœ‰æŸç§å¼‚å¸¸ï¼Œæˆ–è€…è¯´ï¼Œæˆ‘ä»¬å¸Œæœ›åˆ¤æ–­è¿™ä¸ªå¼•æ“Žæ˜¯å¦éœ€è¦è¿›ä¸€æ­¥æµ‹è¯•ã€‚å› ä¸ºï¼Œå¦‚æžœå®ƒçœ‹èµ·æ¥åƒä¸€ä¸ªæ­£å¸¸çš„å¼•æ“Žï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥ç›´æŽ¥å°†å®ƒè¿é€åˆ°å®¢æˆ·é‚£é‡Œï¼Œè€Œä¸éœ€è¦è¿›ä¸€æ­¥çš„æµ‹è¯•ã€‚

ã€€ã€€ç»™å®šæ•°æ®é›† $\{x^{(1)},x^{(2)},\ldots,x^{(m)}\}$ï¼Œæˆ‘ä»¬å‡ä½¿æ•°æ®é›†æ˜¯æ­£å¸¸çš„ï¼Œæˆ‘ä»¬å¸Œæœ›çŸ¥é“æ–°çš„æ•°æ®  $x^{(test)}$ æ˜¯ä¸æ˜¯å¼‚å¸¸çš„ï¼Œå³è¿™ä¸ªæµ‹è¯•æ•°æ®ä¸å±žäºŽè¯¥ç»„æ•°æ®çš„å‡ çŽ‡å¦‚ä½•ã€‚æˆ‘ä»¬æ‰€æž„å»ºçš„æ¨¡åž‹åº”è¯¥èƒ½æ ¹æ®è¯¥æµ‹è¯•æ•°æ®çš„ä½ç½®å‘Šè¯‰æˆ‘ä»¬å…¶å±žäºŽä¸€ç»„æ•°æ®çš„å¯èƒ½æ€§ $p(x)$ã€‚

![image-20200213204502855](https://tva1.sinaimg.cn/large/0082zybply1gbv27cul6pj30pm0dkjuw.jpg)

ä¸Šå›¾ä¸­ï¼Œè“è‰²åœˆå†…çš„æ•°æ®çœ‹ä¸ŠåŽ»æ•°æ®æ­£å¸¸ç‚¹çš„æ¦‚çŽ‡è¾ƒé«˜ï¼Œè€Œå¤„ç†è“è‰²åœˆå¤–çš„æ•°æ®ï¼Œè·ç¦»è¶Šè¿œï¼Œå±žäºŽæ­£å¸¸æ•°æ®çš„æ¦‚çŽ‡è¶Šä½Žã€‚

å¼‚å¸¸æ£€æµ‹è¿˜å¯ä»¥ç”¨æ¥è¯†åˆ«æ¬ºè¯ˆï¼Œä¾‹å¦‚åœ¨çº¿é‡‡é›†è€Œæ¥çš„æœ‰å…³ç”¨æˆ·çš„æ•°æ®ï¼Œä¸€ä¸ªç‰¹å¾å‘é‡ä¸­å¯èƒ½ä¼šåŒ…å«å¦‚ï¼šç”¨æˆ·å¤šä¹…ç™»å½•ä¸€æ¬¡ï¼Œè®¿é—®è¿‡çš„é¡µé¢ï¼Œåœ¨è®ºå›å‘å¸ƒçš„å¸–å­æ•°é‡ï¼Œç”šè‡³æ˜¯æ‰“å­—é€Ÿåº¦ç­‰ã€‚å°è¯•æ ¹æ®è¿™äº›ç‰¹å¾æž„å»ºä¸€ä¸ªæ¨¡åž‹ï¼Œå¯ä»¥ç”¨è¿™ä¸ªæ¨¡åž‹æ¥è¯†åˆ«é‚£äº›ä¸ç¬¦åˆè¯¥æ¨¡å¼çš„ç”¨æˆ·ã€‚

# äºŒã€å¼‚å¸¸æ£€æµ‹åŽŸç†

## 2.1 é«˜æ–¯åˆ†å¸ƒ

å‡è®¾å˜é‡ $x$ æœä»Žé«˜æ–¯åˆ†å¸ƒ $N(\mu,\sigma^2)$ï¼Œåˆ™å…¶æ¦‚çŽ‡å¯†åº¦å‡½æ•°ä¸º
$$
p\left(\mu, \sigma^{2}\right)=\frac{1}{\sqrt{2 \pi} \sigma} \exp \left(-\frac{(x-\mu)^{2}}{2 \sigma^{2}}\right)
$$
å¯†åº¦åˆ†å¸ƒå‡½æ•°å›¾å¦‚ä¸‹æ‰€ç¤º

![image-20200213205234506](https://tva1.sinaimg.cn/large/0082zybply1gbv2f6w2isj318e0jo46s.jpg)

è‹¥æ•°æ®ä¸º  $\{x^{(1)},x^{(2)},\ldots,x^{(m)}\}$ ï¼Œåˆ™
$$
\begin{aligned} \mu &= \frac{1}{m} \sum_{i=1}^{m} x^{(i)} \\ \sigma^{2} &=\frac{1}{m} \sum_{i=1}^{m}\left(x^{(i)}-\mu\right)^{2} \end{aligned}
$$


## 2.2 å¼‚å¸¸æ£€æµ‹ç®—æ³•

æœ¬æ–‡åŸºäºŽé«˜æ–¯åˆ†å¸ƒå¼€å‘å¼‚å¸¸æ£€æµ‹ç®—æ³•ï¼Œå‡è®¾æ•°æ®é›†ä¸º  $\{x^{(1)},x^{(2)},\ldots,x^{(m)}\}$ï¼Œç»´åº¦ä¸º $n$ï¼Œå…¶ç®—æ³•æµç¨‹å¦‚ä¸‹

>1. é€‰å®šå¯èƒ½å‡ºçŽ°å¼‚å¸¸çš„æ•°æ® $x^{(i)}$
>2. è®¡ç®—å‚æ•° $\mu_{1}, \dots, \mu_{n}, \sigma_{1}^{2}, \dots, \sigma_{n}^{2}$
    $$
    \begin{aligned} \mu_{j} &=\frac{1}{m} \sum_{i=1}^{m} x_{j}^{(i)} \\ \sigma_{j}^{2} &=\frac{1}{m} \sum_{i=1}^{m}\left(x_{j}^{(i)}-\mu_{j}\right)^{2} \end{aligned}\tag{1}
    $$
>3. è®¡ç®—æ¦‚çŽ‡ $p(x)$
    $$
    p(x)=\prod_{j=1}^{n} p\left(x_{j} ; \mu_{j}, \sigma_{j}^{2}\right)=\prod_{j=1}^{n} \frac{1}{\sqrt{2 \pi} \sigma_{j}} \exp \left(-\frac{\left(x_{j}-\mu_{j}\right)^{2}}{2 \sigma_{j}^{2}}\right) \tag{2}
    $$
>    å¦‚æžœ $p(x)<\varepsilon$ï¼Œ åˆ™æ•°æ®å¼‚å¸¸

ä¸¾ä¸ªðŸŒ°ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤º

![image-20200213210840139](https://tva1.sinaimg.cn/large/0082zybply1gbv2vxig06j31by0si4l8.jpg)

è®¾å®š $\varepsilon=0.02$ ï¼Œæ•°æ®é›†æœ‰ä¸¤ä¸ªç»´åº¦ï¼Œå…¶æ¦‚çŽ‡å¯†åº¦å‡½æ•°åˆ†åˆ«å¦‚ä¸Šå›¾çš„å³ä¸Šè§’æ‰€ç¤ºï¼Œç»™å®šæµ‹è¯•æ•°æ®ï¼ŒæŒ‰ç…§å¼ $(2)$ è®¡ç®—å…¶æ¦‚çŽ‡ï¼Œé€šè¿‡æ¯”è¾ƒä¸Ž $\varepsilon$ çš„å¤§å°ç¡®å®šæ˜¯å¦å¼‚å¸¸ã€‚

# ä¸‰ã€å¼€å‘å¼‚å¸¸æ£€æµ‹ç³»ç»Ÿ

## 3.1 å¼‚å¸¸æ£€æµ‹ç³»ç»Ÿè¯„ä¼°æ–¹æ³•

å¼‚å¸¸æ£€æµ‹ç®—æ³•æ˜¯ä¸€ä¸ªéžç›‘ç£å­¦ä¹ ç®—æ³•ï¼Œæ„å‘³ç€æˆ‘ä»¬æ— æ³•æ ¹æ®ç»“æžœå˜é‡ $y$ çš„å€¼æ¥å‘Šè¯‰æˆ‘ä»¬æ•°æ®æ˜¯å¦çœŸçš„æ˜¯å¼‚å¸¸çš„ã€‚æˆ‘ä»¬éœ€è¦å¦ä¸€ç§æ–¹æ³•æ¥å¸®åŠ©æ£€éªŒç®—æ³•æ˜¯å¦æœ‰æ•ˆã€‚å½“æˆ‘ä»¬å¼€å‘ä¸€ä¸ªå¼‚å¸¸æ£€æµ‹ç³»ç»Ÿæ—¶ï¼Œä¸€èˆ¬æƒ…å†µä¸‹çš„æ•°æ®åˆ†é…å¦‚ä¸‹

+ è®­ç»ƒé›†$x^{(1)},x^{(2)},\ldots,x^{(m)}$ï¼ˆæ­£å¸¸æ•°æ®ï¼‰ï¼Œ60%
+ äº¤å‰éªŒè¯é›† $(x^{(1)}_{cv},y^{(1)}_{cv}),x^{(2)}_{cv},y^{(2)}_{cv}),\ldots,x^{(m)}_{cv},y^{(m)}_{cv})$ï¼Œ20%
+ æµ‹è¯•é›† $(x^{(1)}_{test},y^{(1)}_{test}),x^{(2)}_{test},y^{(2)}_{test}),\ldots,x^{(m)}_{test},y^{(m)}_{test})$ï¼Œ20%

> ä¸¾ä¸ªðŸŒ°ï¼Œæˆ‘ä»¬æœ‰10000å°æ­£å¸¸å¼•æ“Žçš„æ•°æ®ï¼Œæœ‰20å°å¼‚å¸¸å¼•æ“Žçš„æ•°æ®ã€‚æˆ‘ä»¬è¿™æ ·åˆ†é…æ•°æ®ï¼š
>
> + 6000å°æ­£å¸¸å¼•æ“Žçš„æ•°æ®ä½œä¸ºè®­ç»ƒé›†
>
> + 2000å°æ­£å¸¸å¼•æ“Žå’Œ10å°å¼‚å¸¸å¼•æ“Žçš„æ•°æ®ä½œä¸ºäº¤å‰æ£€éªŒé›†
>
> + 2000å°æ­£å¸¸å¼•æ“Žå’Œ10å°å¼‚å¸¸å¼•æ“Žçš„æ•°æ®ä½œä¸ºæµ‹è¯•é›†

å…·ä½“çš„è¯„ä¼°ç®—æ³•å¦‚ä¸‹

>1. æ ¹æ®æµ‹è¯•é›†æ•°æ®ï¼Œæˆ‘ä»¬ä¼°è®¡ç‰¹å¾çš„å¹³å‡å€¼å’Œæ–¹å·®å¹¶æž„å»º $p(x)$å‡½æ•°
>2. å¯¹äº¤å‰æ£€éªŒé›†ï¼Œæˆ‘ä»¬å°è¯•ä½¿ç”¨ä¸åŒçš„ $Îµ$ å€¼ä½œä¸ºé˜€å€¼ï¼Œå¹¶é¢„æµ‹æ•°æ®æ˜¯å¦å¼‚å¸¸ï¼Œæ ¹æ® $F1$ å€¼æˆ–è€…ç²¾ç¡®çŽ‡/å¬å›žçŽ‡çš„æ¯”ä¾‹æ¥é€‰æ‹© $Îµ$
>3. é€‰å‡º $Îµ$ åŽï¼Œé’ˆå¯¹æµ‹è¯•é›†è¿›è¡Œé¢„æµ‹ï¼Œè®¡ç®—å¼‚å¸¸æ£€éªŒç³»ç»Ÿçš„ $F1$ å€¼æˆ–è€…ç²¾ç¡®çŽ‡/å¬å›žçŽ‡çš„æ¯”ä¾‹

## 3.2 æ•°æ®é¢„å¤„ç†

å¯¹äºŽå¼‚å¸¸æ£€æµ‹ç®—æ³•ï¼Œæˆ‘ä»¬ä½¿ç”¨çš„ç‰¹å¾æ˜¯è‡³å…³é‡è¦çš„ï¼Œä¸‹é¢è°ˆè°ˆå¦‚ä½•é€‰æ‹©ç‰¹å¾ã€‚

**å¼‚å¸¸æ£€æµ‹å‡è®¾ç‰¹å¾ç¬¦åˆé«˜æ–¯åˆ†å¸ƒ**ï¼Œå¦‚æžœæ•°æ®çš„åˆ†å¸ƒä¸æ˜¯é«˜æ–¯åˆ†å¸ƒï¼Œé‚£å¼‚å¸¸æ£€æµ‹ç®—æ³•æ€Žä¹ˆå·¥ä½œå‘¢ï¼Ÿæ–¹æ³•å°±æ˜¯å°†åŽŸå§‹æ•°æ®å°½å¯èƒ½çš„è½¬æ¢ä¸ºé«˜æ–¯åˆ†å¸ƒçš„æ•°æ®ã€‚ä¸¾ä¸ªðŸŒ°ï¼Œä¸‹å›¾ä¸­å·¦è¾¹æ˜¯åŽŸå§‹æ•°æ®åˆ†å¸ƒï¼Œé€šè¿‡ $\log(x)$ çš„å¤„ç†å°±å¯ä»¥è½¬æ¢ä¸ºé«˜æ–¯åˆ†å¸ƒçš„æ•°æ®ã€‚

![image-20200213232315517](https://tva1.sinaimg.cn/large/0082zybply1gbv6rzcpd7j314k0d4wkd.jpg)

# å››ã€åŸºäºŽå¤šå…ƒé«˜æ–¯åˆ†å¸ƒçš„å¼‚å¸¸æ£€æµ‹

## 4.1 å¤šå…ƒé«˜æ–¯åˆ†å¸ƒ

å‡è®¾æœ‰ç‰¹å¾å˜é‡ $x \in \R^n$ ï¼Œä¸ä¸º $p(x_1),p(x_2),\ldots,p(x_n)$ å•ç‹¬å»ºæ¨¡ï¼Œè€Œæ˜¯å»ºç«‹ä¸€ä¸ªæ•´ä½“çš„ $p(x)$ æ¨¡åž‹å¦‚ä¸‹
$$
p(x)=\frac{1}{(2 \pi)^{\frac{n}{2}}|\Sigma|^{\frac{1}{2}}} \exp \left(-\frac{1}{2}(x-\mu)^{T} \Sigma^{-1}(x-\mu)\right) \tag{3}
$$
å…¶ä¸­ï¼Œ$\mu$ ä¸ºå‡å€¼ï¼Œ$\Sigma$ ä¸ºåæ–¹å·®çŸ©é˜µã€‚

ä¸‹é¢æˆ‘ä»¬æ¥çœ‹çœ‹åæ–¹å·®çŸ©é˜µæ˜¯å¦‚ä½•å½±å“æ¨¡åž‹çš„ã€‚

![img](https://tva1.sinaimg.cn/large/0082zybply1gbx5iq3e07j30r209010m.jpg)

ä¸Šå›¾æ˜¯5ä¸ªä¸åŒçš„æ¨¡åž‹ï¼Œä»Žå·¦å¾€å³ä¾æ¬¡åˆ†æžï¼š

>  1.æ˜¯ä¸€ä¸ªä¸€èˆ¬çš„é«˜æ–¯åˆ†å¸ƒæ¨¡åž‹
>  2.é€šè¿‡åæ–¹å·®çŸ©é˜µï¼Œä»¤ç‰¹å¾1æ‹¥æœ‰è¾ƒå°çš„åå·®ï¼ŒåŒæ—¶ä¿æŒç‰¹å¾2çš„åå·®
>  3.é€šè¿‡åæ–¹å·®çŸ©é˜µï¼Œä»¤ç‰¹å¾2æ‹¥æœ‰è¾ƒå¤§çš„åå·®ï¼ŒåŒæ—¶ä¿æŒç‰¹å¾1çš„åå·®
>  4.é€šè¿‡åæ–¹å·®çŸ©é˜µï¼Œåœ¨ä¸æ”¹å˜ä¸¤ä¸ªç‰¹å¾çš„åŽŸæœ‰åå·®çš„åŸºç¡€ä¸Šï¼Œå¢žåŠ ä¸¤è€…ä¹‹é—´çš„æ­£ç›¸å…³æ€§
>  5.é€šè¿‡åæ–¹å·®çŸ©é˜µï¼Œåœ¨ä¸æ”¹å˜ä¸¤ä¸ªç‰¹å¾çš„åŽŸæœ‰åå·®çš„åŸºç¡€ä¸Šï¼Œå¢žåŠ ä¸¤è€…ä¹‹é—´çš„è´Ÿç›¸å…³æ€§

å¤šå…ƒé«˜æ–¯åˆ†å¸ƒæ¨¡åž‹ä¸ŽåŽŸé«˜æ–¯åˆ†å¸ƒæ¨¡åž‹çš„å…³ç³»ï¼š

> å¯ä»¥è¯æ˜Žçš„æ˜¯ï¼ŒåŽŸæœ¬çš„é«˜æ–¯åˆ†å¸ƒæ¨¡åž‹æ˜¯å¤šå…ƒé«˜æ–¯åˆ†å¸ƒæ¨¡åž‹çš„ä¸€ä¸ªå­é›†ï¼Œå³åƒä¸Šå›¾ä¸­çš„ç¬¬1ã€2ã€3ï¼Œ3ä¸ªä¾‹å­æ‰€ç¤ºï¼Œå¦‚æžœåæ–¹å·®çŸ©é˜µåªåœ¨å¯¹è§’çº¿çš„å•ä½ä¸Šæœ‰éžé›¶çš„å€¼æ—¶ï¼Œå³ä¸ºåŽŸæœ¬çš„é«˜æ–¯åˆ†å¸ƒæ¨¡åž‹ã€‚

åŽŸé«˜æ–¯åˆ†å¸ƒæ¨¡åž‹è¢«å¹¿æ³›ä½¿ç”¨ç€ï¼Œå¦‚æžœç‰¹å¾ä¹‹é—´åœ¨æŸç§ç¨‹åº¦ä¸Šå­˜åœ¨ç›¸äº’å…³è”çš„æƒ…å†µï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡æž„é€ æ–°æ–°ç‰¹å¾çš„æ–¹æ³•æ¥æ•æ‰è¿™äº›ç›¸å…³æ€§ã€‚å½“è®­ç»ƒé›†ä¸æ˜¯å¤ªå¤§ï¼Œå¹¶ä¸”æ²¡æœ‰å¤ªå¤šçš„ç‰¹å¾çš„æ—¶å€™ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨å¤šå…ƒé«˜æ–¯åˆ†å¸ƒæ¨¡åž‹ã€‚

## 4.2 å¤šå…ƒé«˜æ–¯åˆ†å¸ƒå¼‚å¸¸æ£€æµ‹ç®—æ³•

å’Œé«˜æ–¯åˆ†å¸ƒçš„ç±»åž‹ï¼Œå¤šå…ƒé«˜æ–¯åˆ†å¸ƒå¼‚å¸¸æ£€æµ‹ç®—æ³•å¦‚ä¸‹

> 1. é€‰å®šå¯èƒ½å‡ºçŽ°å¼‚å¸¸çš„æ•°æ® $x^{(i)}$
> 2. è®¡ç®—å‚æ•° $\mu, \Sigma$
>
> $$
> \begin{aligned}\mu&=\frac{1}{m} \sum_{i=1}^{m} x^{(i)} \\ \Sigma&=\frac{1}{m} \sum_{i=1}^{m}\left(x^{(i)}-\mu\right)\left(x^{(i)}-\mu\right)^{T}\end{aligned}\tag{4}
> $$
>
> 3. è®¡ç®—æ¦‚çŽ‡ $p(x)$
>
> $$
> p(x)=\frac{1}{(2 \pi)^{\frac{n}{2}}|\Sigma|^{\frac{1}{2}}} \exp \left(-\frac{1}{2}(x-\mu)^{T} \Sigma^{-1}(x-\mu)\right)\tag{5}
> $$
>
> å¦‚æžœ $p(x)<\varepsilon$ï¼Œ åˆ™æ•°æ®å¼‚å¸¸

# äº”ã€å‚è€ƒ

[1] Andrew.Ng æœºå™¨å­¦ä¹ è§†é¢‘

[2] https://www.jianshu.com/p/620b584c2941